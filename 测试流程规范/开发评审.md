#开发设计问题发现模型
##异常情况
接口调用失败
mq消息丢失
redis崩溃
##项目角度
文档是否完整准确
任务是否拆分清晰
排期是否合理
##数据层面
表数据对象没有包含该对象完整的数据属性
数据对象是否包含不应该存在的多余数据对象
表字段是否满足单一职责
表字段是否存在二义性
##逻辑层面
梳理新流程是否有遗漏的外部系统需要改动
梳理已有的数据特性，检查新逻辑是否兼容所有类型数据，包括历史数据
接口设计是否合理
设计是否能够通用
设计对原有系统侵入是否最小，是否做到充分解耦
##特定技术栈问题
###redis技术栈检查套路
redis是否考虑数据的主动刷新、数据穿透、容灾、数据全量恢复等问题。
需要在设计初期对这些情况进行计划
用例：
redis数据丢失：
步骤：清空redis数据
预期：击穿redis从db中获取到正常的数据，并正常回写；
步骤：启动redis数据恢复功能
预期：可以从redis中获取正确的数据
redis崩溃
步骤：制造redis崩溃场景
预期：降级从db中获取到正常的数据
###mq技术栈检查套路
mq丢消息、时序性等问题
循环推送和成功状态回写、接收消息回调获取最新消息
mq消息积压：
步骤：制造mq消息积压场景
预期：故障恢复后，积压消息正常处理，数据无丢失，速率正常，无时序性问题
mq崩溃：
步骤：制造mq崩溃场景
预期：新请求有对应的返回信息，已经进入的数据有还原策略
###task技术栈检查套路
任务防重措施、防漏措施、处理结果幂等性。
首先要确认任务处理幂等性，调整合适的偏移量和执行频率
###db技术栈检查套路
普通索引合理性
是否存在锁表问题、数据线程安全。
当前读条件是否添加索引，共享数据争抢的逻辑是否加线程锁和分布式锁
db崩溃：
步骤：db崩溃
预期：db多活策略启动，功能无影响
db数据丢失：
步骤：db数据丢失
预期：启动数据恢复策略，规定时间内数据恢复，并产出恢复结果
###接口服务异常
接口服务重启
步骤：制造部分实例重启场景
预期：所有请求无异常
集群崩溃
步骤：制造集群崩溃场景
预期：内部服务器有重试机制
###基于线程安全的测试
数据库锁原理
1.表锁定：更新/删除操作会添加排他锁。此类操作的where条件如果没有添加索引，会升级为表级锁定，导致其他逻辑对该表的操作失败
2.事务中死锁：两个事务都持有对方需要的锁，并且在等待对方释放，并且双方都不会释放自己的锁；

线程安全性问题出现的3个必要条件
1.多线程环境
2.多线程共享同一个资源（db等）
3.对资源进行非原子性操作

并发测试
步骤：并发相同的数据
预期：只有一条数据操作成功
分布式测试
步骤：分布式环境下，并发相同的数据
预期：只有一条数据操作成功
线程安全测试
步骤：同时并发修改和删除
预期：修改和删除能够同时进行，互不影响




